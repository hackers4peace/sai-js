{
  "@context": [
    "https://linkedsoftwaredependencies.org/bundles/npm/@solid/community-server/^8.0.0/components/context.jsonld",
    "https://linkedsoftwaredependencies.org/bundles/npm/asynchronous-handlers/^1.0.0/components/context.jsonld",
    "https://linkedsoftwaredependencies.org/bundles/npm/@elfpavlik/sai-components/^1.0.0/components/context.jsonld"
  ],
  "import": [
    "css:config/app/init/initialize-root.json",
    "css:config/app/main/default.json",
    "css:config/app/variables/default.json",
    "css:config/http/handler/default.json",
    "css:config/http/middleware/default.json",
    "css:config/http/notifications/all.json",
    "css:config/http/server-factory/https.json",
    "css:config/http/static/default.json",
    "css:config/identity/access/public.json",
    "css:config/identity/email/default.json",
    "css:config/identity/handler/default.json",
    "css:config/identity/oidc/disabled.json",
    "css:config/identity/ownership/unsafe-no-check.json",
    "css:config/identity/pod/static.json",
    "css:config/ldp/authentication/dpop-bearer.json",
    "sai:config/ldp/authorization/sai.json",
    "css:config/ldp/handler/default.json",
    "css:config/ldp/metadata-parser/default.json",
    "css:config/ldp/metadata-writer/default.json",
    "css:config/ldp/modes/default.json",

    "sai:config/storage/key-value/memory.json",
    "sai:config/storage/key-value/postgres.json",
    "css:config/storage/location/pod.json",
    "css:config/storage/middleware/default.json",
    "css:config/util/auxiliary/empty.json",
    "css:config/util/identifiers/suffix.json",
    "css:config/util/index/default.json",
    "css:config/util/logging/winston.json",
    "css:config/util/representation-conversion/default.json",
    "css:config/util/resource-locker/memory.json",
    "css:config/util/variables/default.json",

    "css:config/storage/backend/data-accessors/file.json",
    "css:config/storage/backend/data-accessors/sparql-endpoint.json"
  ],
  "@graph": [
    {
      "comment": "Necessary for the policy-engine.",
      "@id": "urn:sai:policy-engine:AuthorizationManager",
      "@type": "SaiAuthorizationManager",
      "identifierStrategy": { "@id": "urn:solid-server:default:IdentifierStrategy" },
      "sparqlEndpoint": { "@id": "urn:solid-server:default:variable:sparqlEndpoint" },
      "storageStrategy": { "@id": "urn:solid-server:default:StorageLocationStrategy" }
    },
    {
      "@id": "urn:sai:default:OverrideBaseHttpHandler",
      "@type": "Override",
      "overrideInstance": { "@id": "urn:solid-server:default:BaseHttpHandler" },
      "overrideSteps": [
        {
          "@type": "OverrideListRemove",
          "overrideParameter": { "@id": "StatusWaterfallHandler:_handlers" },
          "overrideTarget":  { "@id": "urn:solid-server:default:AuthResourceHttpHandler" }
        }
      ]
    },
    {
      "@id": "urn:solid-server:default:ResourceStore_Backend",
      "@type": "RoutingResourceStore",
      "rule": { "@id": "urn:solid-server:default:RouterRule" }
    },
    {
      "comment": "Configure routing to send RDF sparql store and all other data to file system.",
      "@id": "urn:solid-server:default:RouterRule",
      "@type": "ConvertingRouterRule",
      "typedStores": [
        {
          "@id": "urn:sai:default:SparqlStoreEntry",
          "@type": "SparqlStoreEntry",
          "store": { "@id": "urn:solid-server:default:SparqlResourceStore" },
          "converter": { "@id": "urn:solid-server:default:RdfToQuadConverter" }
        }
      ],
      "defaultStore": {
        "@id": "urn:solid-server:default:FileResourceStore"
      }
    },

    {
      "@id": "urn:solid-server:default:FileResourceStore",
      "@type": "DataAccessorBasedStore",
      "identifierStrategy": { "@id": "urn:solid-server:default:IdentifierStrategy" },
      "auxiliaryStrategy": { "@id": "urn:solid-server:default:AuxiliaryStrategy" },
      "accessor": { "@id": "urn:solid-server:default:FileDataAccessor" },
      "metadataStrategy": { "@id": "urn:solid-server:default:MetadataStrategy" }
    },
    {
      "@id": "urn:solid-server:default:SparqlResourceStore",
      "@type": "RepresentationConvertingStore",
      "metadataStrategy": { "@id": "urn:solid-server:default:MetadataStrategy" },
      "options_inConverter": { "@id": "urn:solid-server:default:RepresentationConverter" },
      "options_inPreferences_type": {
        "RepresentationConvertingStore:_options_inPreferences_type_key": "internal/quads",
        "RepresentationConvertingStore:_options_inPreferences_type_value": 1
      },
      "source": {
        "@type": "DataAccessorBasedStore",
        "identifierStrategy": { "@id": "urn:solid-server:default:IdentifierStrategy" },
        "auxiliaryStrategy": { "@id": "urn:solid-server:default:AuxiliaryStrategy" },
        "accessor": { "@id": "urn:solid-server:default:SparqlDataAccessor" },
        "metadataStrategy": { "@id": "urn:solid-server:default:MetadataStrategy" }
      }
    },

    {
      "@id": "urn:solid-server:default:PrimaryParallelInitializer",
      "@type": "ParallelHandler",
      "handlers": [
        { "@id": "urn:solid-server:default:KeyValueStorage" }
      ]
    },
    {
      "@id": "urn:solid-server:default:EarlyProcessParallelInitializer",
      "@type": "ParallelHandler",
      "handlers": [
        { "@id": "urn:solid-server:default:KeyValueStorage" }
      ]
    }
  ]
}
